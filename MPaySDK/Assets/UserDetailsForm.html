<!DOCTYPE html>
<html>
<head>
    <script>
        String.prototype.b64encode = function () {
            return btoa(unescape(encodeURIComponent(this)));
        };
        String.prototype.b64decode = function () {
            return decodeURIComponent(escape(atob(this)));
        };

        function submitUserInfo() {
            // var fileToLoad = document.getElementById("fileToLoad").files[0];
            var firstname = document.getElementById("firstname").value;
            var lastname = document.getElementById("lastname").value;
            let json = {"firstname": firstname, "lastname": lastname};
            window.webkit.messageHandlers.USER_DETAILS.postMessage(json);

            // Not using for now but can be optimised for better solutions.
            // var fileReader = new FileReader();
            // fileReader.onload = function (fileLoadedEvent) {
            //     var textFromFileLoaded = fileLoadedEvent.target.result;
            //     // console.log(textFromFileLoaded.b64encode());
            //     // console.log(textFromFileLoaded.b64encode().b64decode());
            //     window.webkit.messageHandlers.USER_DETAILS.postMessage(textFromFileLoaded.b64encode());
            // };
            //
            // fileReader.readAsText(fileToLoad, "UTF-8");
        }

        function imageLoaded() {
            // profilepicture
            var firstname = document.getElementById("profilepicture").value;
        }
    </script>
</head>
<body>

<form action="/action_page.php">
    Profile Picture:<br><input type="image" id="profilepicture"><br>
    First name:<br><input id="firstname" type="text" name="FirstName" value="Mickey"><br>
    Last name:<br><input id="lastname" type="file" name="LastName" value="Mouse"><br>
    <input type="button" onclick="submitUserInfo()" value="Submit" onchange="imageLoaded()"><br>

</form>

<p>Click the "Submit"</p>

</body>
</html>

